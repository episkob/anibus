# Anibus — Продвинутый сканер портов

Современное десктопное приложение для сканирования портов с углубленным анализом безопасности, созданное с использованием **Anibus Design System**, **JavaFX 21.0.5** и **Java 21**.

> **Версия:** 1.3.0 · **Автор:** Iaroslav Tsymbaliuk · **Должность:** Intern (2025–2026) @ r2u

---

## Возможности

### Базовое сканирование
- Сканирование любого имени хоста или IP-адреса на открытые порты
- Настраиваемый диапазон портов (например, `1-65535`)
- Регулируемое количество потоков (10–500, по умолчанию 10)
- Измерение **задержки (latency)** для каждого порта (мс)
- Плавная отмена сканирования с архитектурой SOLID

### Расширенное определение сервисов
- Два режима сканирования: **Быстрое сканирование** и **Определение сервисов**
- **Продвинутое определение сервисов** для 100+ служб (HTTP, SSH, FTP, MySQL, PostgreSQL, Redis, MongoDB, Elasticsearch, Kubernetes API, Jenkins и др.)
- **Захват баннеров** с протокол-специфичными зондами (HTTP HEAD, SSH приветствие, SMTP, FTP, рукопожатие MySQL)
- **Извлечение версии ПО** из баннеров (OpenSSH, Apache, nginx, ProFTPD, Postfix и др.)
- **Определение операционной системы** через TCP отпечатки и анализ баннеров
- **Сканирование уязвимостей** с сопоставлением базы данных CVE (уровни серьезности ВЫСОКИЙ/СРЕДНИЙ/КРИТИЧЕСКИЙ)
- **Сервисы геолокации** — местоположение IP, провайдер, ASN, определение облачного провайдера
- **Анализ SSL/TLS сертификатов** — даты истечения, определение самоподписанных, детали сертификатов

### Анализ безопасности
- **Определение Keycloak IAM** — автоматически находит серверы Keycloak по путям `/auth/`, `/keycloak/`, пользовательским путям
- **Извлечение криптографических ключей** — находит открытые публичные/приватные ключи и секреты клиентов
- **Поддержка множества realm'ов** — определяет `master` и пользовательские realm'ы
- **Анализ заголовков безопасности** — Content Security Policy, HSTS, X-Frame-Options и др.
- **Определение HTTP технологий** — идентификация CMS (WordPress, Drupal, Magento), веб-серверов, фреймворков
- **Определение IoT устройств** — IP камеры, DVR, маршрутизаторы с предупреждениями о стандартных учетных данных

### Извлечение информации
- **Анализ исходного кода веб-страниц** — обнаруживает утечки учетных данных, API ключей, конфигурационных файлов
- **Определение облачных сервисов** — Cloudflare, AWS, Azure, Akamai, идентификация WAF/CDN
- **Анализ программного стека** — Kubernetes, Docker, Jenkins CI/CD, инструменты HashiCorp

### Интерфейс и рабочий процесс
- **Тёмная тема** — полный дизайн в тёмном режиме с оптимизированным контрастом и читаемостью
- **Консольный вид** — переключение между табличным и консольным отображением результатов в стиле терминала
- **Определение SSL/TLS** — автоматическая проверка поддержки HTTPS при разрешении хостов (индикатор галочка/X)
- **Умная обработка URL** — автоматическое удаление префиксов http:// и https://, извлечение имени хоста из полных URL
- **Индикатор состояния сети** — живой статус подключения в строке статуса ([ОНЛАЙН], [ЛОКАЛЬНАЯ], [ОФЛАЙН]), опрашивается каждые 5 секунд
- **Панель информации о хосте** — IP, имя хоста, время сканирования, количество проверенных и открытых портов, средняя задержка (обновляется в реальном времени)
- **Экспорт в CSV или XML** со всеми колонками и данными расширенного определения сервисов
- **Очистка** результатов одним нажатием
- **Копирование строки** или **всех результатов** через контекстное меню
- **Копирование IP-адреса** из метки разрешенного хоста через правую кнопку мыши
- Автоматическое определение DNS при потере фокуса
- **Anibus Design System**: стеклянная навигация, градиентные кнопки, тонкие полосы прокрутки, скруглённые карточки, цветовое кодирование состояния
- **Текстовый вывод** — чистое ASCII форматирование для универсальной совместимости с консолью

---

## Структура проекта

```
src/
└── main/
    ├── java/
    │   ├── module-info.java
    │   └── it/r2u/anibus/
    │       ├── AnibusApplication.java          # Точка входа JavaFX
    │       ├── AnibusController.java           # Контроллер UI (рефакторинг SOLID, компактный)
    │       │
    │       ├── coordinator/                     # Оркестрация сканирования (паттерны Strategy & Facade)
    │       │   ├── ScanStrategy.java            # Интерфейс стратегии типов сканирования
    │       │   ├── ScanContext.java             # Паттерн Builder для параметров сканирования
    │       │   ├── ScanCoordinator.java         # Facade для управления стратегиями
    │       │   ├── StandardScanStrategy.java    # Стратегия быстрого TCP сканирования
    │       │   └── ServiceDetectionStrategy.java # Стратегия детального определения сервисов
    │       │
    │       ├── handlers/                        # Обработчики действий (паттерн Command)
    │       │   ├── ScanActionHandler.java       # Жизненный цикл сканирования и обновление UI
    │       │   ├── ClipboardActionHandler.java  # Операции с буфером обмена
    │       │   ├── ExportActionHandler.java     # Функциональность экспорта
    │       │   └── TracerouteActionHandler.java # Трассировка сетевого пути
    │       │
    │       ├── model/
    │       │   ├── PortScanResult.java          # Модель данных (7 полей)
    │       │   └── PortRegistry.java            # Таблицы сервисов и протоколов/шифрования
    │       │
    │       ├── network/
    │       │   ├── HostResolver.java            # Разрешение DNS и определение SSL
    │       │   └── NetworkStatusMonitor.java    # Мониторинг сетевого подключения
    │       │
    │       ├── service/
    │       │   ├── PortScannerService.java      # Основная логика сканирования
    │       │   ├── ScanTask.java                # Фоновая задача Task<Void> с коллбэками
    │       │   ├── ServiceDetectionTask.java    # Задача детального определения
    │       │   ├── EnhancedServiceDetector.java # Глубокое определение сервисов
    │       │   ├── BannerGrabber.java           # Захват баннеров (HTTP HEAD / сырое приветствие)
    │       │   ├── VersionExtractor.java        # Извлечение версии (regex)
    │       │   ├── ExportService.java           # Экспорт в CSV и XML
    │       │   ├── OSDetector.java              # Определение операционной системы
    │       │   ├── VulnerabilityScanner.java    # Сопоставление с базой CVE
    │       │   ├── GeolocationService.java      # Геолокация IP через ip-api.com
    │       │   ├── HTTPAnalyzer.java            # SSL сертификаты, заголовки безопасности, CMS
    │       │   ├── TracerouteService.java       # Трассировка сетевого пути
    │       │   ├── IoTDetector.java             # Определение IP-камер и IoT-устройств
    │       │   ├── KeycloakDetector.java        # Обнаружение Keycloak IAM и извлечение ключей
    │       │   └── SoftwareStackDetector.java   # Анализ технологического стека
    │       │
    │       └── ui/
    │           ├── AlertHelper.java             # Стилизованные диалоги Anibus Design System
    │           ├── ClipboardService.java        # Утилиты копирования в буфер обмена
    │           ├── ConsoleViewManager.java      # Управление выводом консоли
    │           ├── InfoCardManager.java         # Управление информационной панелью
    │           └── TableConfigurator.java       # Настройка колонок таблицы
    │
    └── resources/
        └── it/r2u/anibus/
            ├── hello-view.fxml                  # Макет интерфейса
            ├── anibus-style.css                 # Таблица стилей Anibus Design System
            └── app.properties                   # Версия приложения (фильтруется Maven)
```

---

## Требования

| Инструмент | Версия |
|------------|--------|
| Java       | 21+    |
| JavaFX     | 21.0.5 |
| Maven      | 3.8+   |

---

## Сборка и запуск

```bash
# Клонировать репозиторий
git clone https://github.com/episkob/anibus.git
cd anibus

# Запуск через Maven
./mvnw javafx:run
```

На Windows:

```cmd
mvnw.cmd javafx:run
```

---

## Использование

1. **Выберите режим сканирования** — «Быстрое сканирование» (базовая связь) или «Определение сервисов» (комплексный анализ)
2. Введите **целевой хост** (имя хоста или IP-адрес)
3. Введите **диапазон портов** в формате `start-end` (например, `1-65535` или `80,443`)
4. При необходимости настройте **количество потоков** (больше = быстрее, но агрессивнее)
5. Нажмите **Start Scan**
6. Появится **панель информации о хосте** с живой статистикой сканирования
7. Результаты заполняют таблицу по мере обнаружения портов
8. В режиме **Определение сервисов** получите расширенные данные: определение ОС, уязвимости, геолокацию, анализ Keycloak
9. Нажмите **Stop** для остановки сканирования в любой момент
10. Используйте **Export** для сохранения результатов в **CSV или XML** с полными данными анализа, или **Clear** для сброса
11. Щелкните правой кнопкой мыши по любой строке для копирования результатов или IP-адресов
7. Нажмите **Stop** для прерывания сканирования в любой момент
8. Используйте **Export** для сохранения в **CSV или XML**, или **Clear** для сброса
9. Кликните правой кнопкой мыши для копирования одной строки или всех результатов

---

## Технологии

- **Java 21** — язык программирования
- **JavaFX 21.0.5** — UI-фреймворк
- **Maven** — инструмент сборки
- **FXML** — декларативная разметка интерфейса
- **CSS** — стилизация Anibus Design System

---

## Лицензия

Лицензия MIT. Подробнее — в файле `LICENSE`.
